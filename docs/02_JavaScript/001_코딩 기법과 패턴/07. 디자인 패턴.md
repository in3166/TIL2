## 싱글톤(Singleton)

- 특정 클래스의 인스턴스를 하나만 유지
- 두 번째부터 만들어진 객체는 처음 만들어진 객체를 얻는다.

- JS에는 클래스가 없고 실제론 모두 객체이며, 이 객체는 서로 다 다르므로 이미 싱글톤이다.
  - 객체 리터럴로 만든 단순 객체도 싱글톤이다.

### new 사용하기

- 생성자 함수를 사용해 객체를 만드는 `new` 구문에서 싱글톤 구현하기
- 동일한 생성자로 `new`를 사용해 여러 객체를 만들 때, 실제론 동일한 객체에 대한 포인터만 반환하도록 한다. (참조)
- 객체의 인스턴스 `this`가 생성되면 캐시 후, 다음부턴 캐시된 인스턴스를 반환
  - 선택사항
    - 인스턴스 저장을 위해 전역 변수 사용 (전역 변수 사용은 좋지 않으므로 추천x)
    - 생성자의 스태틱 프로퍼티에 인스턴스 저장
    - 인스턴스를 클로저로 감싼다. (인스턴스를 비공개로 만들어 외부에서 수정x)

### 스태틱 프로퍼티에 인스턴스 저장하기

- `instance`가 공개되어 있어 수정될 위험이 있다.

```js
function Universe() {
  if(typeof Universe.instance === "object") {
    return Universe.instance;
  }
  this.bang = "big";

  Universe.instance = this;
}
```

### 클로저에 인스턴스 저장하기

- 클로저를 사용해 단일 인스턴스를 보호하는 방법
  - 5장의 비공개 스태틱 멤버 패턴 사용
  - 4장의 자기 자신을 정의하는 함수 패턴 사용

```js
function Universe() {
  // 캐싱 인스턴스
  var instance = this;

  this.bang = "big";

  // 생성자 재작성
  Universe = function() {
    return instace;
  }
}
```

- 재작성된 함수는 재정의 시점 이전에 원본 생성자에 추가된 프로퍼티를 잃는다.
  - 프로토타입에 무언가를 추가해도 원본 생성자로 생성된 인스턴스와 연결되지 않는다.

```js
Universe.prototype.nothing = true;
var uni = new Universe();

Universe.prototype.everㅛthing = true;
var uni2 = new Universe();

uni.nothing // true
uni2.nothing // true
uni.everything  // undefined
uni2.everything // unbdefined

// uni.constructor가 재정의된 생성자가 아닌 원본 생성자를 가리킨다.
uni.constuctor.name; // Universe
uni.constructor === Universe; // false
```

- 제대로 작동하도록 수정하기

```js
function Universe() {
  var instance = this;

  this.bang = "big";

  Universe = function Universe() {
    return instace;
  }
  // prototype 프로퍼티 변경
  Universe.prototype = this;

  // instance
  instance = new Universe();
  instance.constructor = Universe;
  instance.bang = "big";

  return instance;
}
```

- 즉시 실행 함수로 감싸기

```js
var Universe;
(function () {
  var instance;

  Universe = function Universe() {
    if(instance) {
      return instance;
    }
    instance = this;
    this.bang = "big";
  };
})
```

<br>

## 팩터리(Factory)

- 클래스 내부 혹은 클래스의 스태틱 메서드로 구현
- 목적
  - 비슷한 객체를 생성하는 반복 작업 수행
  - 팩터리 패턴의 사용자가 컴파일 타임에 구체적인 타입(클래스)을 모르고도 객체 생성 가능(특히, 정적 클래스 언어에서 중요)

- 팩터리 메서드(클래스)로 만들어진 객체들은 의도적으로 동일한 부모 객체를 상속
- 이 객체들은 특화된 기능을 구현하는 구체적인 서브 클래스들이다.
  - 어떤 경우 공통의 부모 클래스가 팩터리 메서드를 갖고 있기도 한다.



### 내장 객체 팩터리

- 

<br>

## 반복자(Iterator)

- 

<br>

## 장식자(Decorator)

- 

<br>

## 퍼사드(Facade)

- 

<br>

## 프록시(Proxy)

- 

<br>

## 중재자(Mediator)

- 

<br>

## 감시자(Observer)

- 

<br><br><br>

<출처>

- JavaScript Patterns