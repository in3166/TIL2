# Monolithic Architecture
- 서비스의 아키텍처를 구성할 때 모든 서비스를 구성하는 비즈니스 로직, DB, UI 등 하나의 패키지에 담아 빌드, 배포하는 방법
<img src="05_ETC/img/msa1.png" width="50%" />

## 한계
- 부분 장애가 전체 서비스 장애로 확대될 수 있다.
- 부분적인 Scale-Out이 어렵다.
- 서비스 변경이 어렵고 수정 시 장애를 일으킬 영향도 파악하기 힘들다.
- 배포 시간이 많이 걸긴다.
- 한 Framwork와 언어에 종속적이다.
<br><br>

# MSA (MicroService Architecture)
- 각자 별도의 프로세스에서 실행되며, HTTP 자원 API 같은 가벼운 매커니즘으로 통신하는 작은 서비스를 모아 하나의 어플리케이션
- 작고, 독립적으로 배포 가능한 각각의 기능을 수행하는 서비스로 구성된 프레임워크
- 하나의 큰 애플리케이션을 여러개의 작을 애플리케이션을 쪼개어 변경과 조합이 가능하도록 만든 아키텍쳐
<img src="05_ETC/img/msa2.png" width="50%" />

## 특징
### API를 통해서만 마이크로서비스와 상호작용할 수 있다.
- 서비스의 end-point을 API 형태로 외부에 노출하고, 세부 사항은 추상화한다.
- 구현 로직, 아키텍처, 프로그래밍 언어, 데이터베이스 등 기술적인 사항들은 숨겨진다.
- `SOA()`의 특징 다수를 공통으로 가진다. 

### 가볍다
- 하나의 비즈니스 범위에 맞춰 하나의 기능만 수행하므로 작은 공간을 차지한다.

### 다양한 언어로 구성 가능
- 서로 다른 마이크로서비스에서 서로 다른 아키텍처를 사용할 수 있다.

### 마이크로서비스 환경에서의 자동화
- 대규모 기업 시스템 안에서 많은 마이크로서비스가 존재할 수 있는데 자동화하지 않으면 관리 부담이 커진다.
  - git, jenkins, travis 같은 지속족 통합도구(CI)를 함께 사용 (코드 품질 검사, 단위 테스트 자동화 포함)
  - 셀레늄, 큐컴버 등 테스트 적략을 사용해 자동화 적용
  - 구성 관리 도구를 사용한 자동화

### 동적이고 분산되어 있다.
- `SOA` 처럼 집중화된 관리 체계 사용 안 함.
- REST 등의 가벼운 통신 아키텍처나 KAFKA 등의 message stream을 주로 사용

### 붕괴 저항성, 빠른 실패, 자체 회복
- 빠른 실패
  - 장애를 예쌍하고 대응할 수 있는 시스템을 만드는데 무게를 둬서 얼머나 빨리 실패하고 복구 할 수 있는지가 중요하다.

- 자체 회복
  - 시스템 장애를 학습하고 스스로 장애를 회복한다.

<br><br>

## 장점
### 복잡성 해결
- 모놀로식과 기능의 수는 동일하지만 각각의 서비스가 모듈화 되어 있어 개별 서비스 개발을 빠르게 유지, 보수도 쉬워진다.

### 개별 배포
- 독립적 배포 가능
- CD도 가볍게 가능

### 개별 Scale-out
- 각각 서비스의 부하에 따라 개별적으로 Scale-out 가능

<br><br>

## 단점
### 분산 시스템에 의한 복잡성 증가
- 개별 서비스가 분산되어 있어 개발자는 내부 시스템 통신을 어떻게 가져야 할 지 정해야 한다.
- 통신 장애, 한 서버의 부하 등이 있을 때 transaction을 유지할 지 결정하고 구현해야 한다.

### 데이터 transaction 일관성
- 분산된 MSA는 비즈니스 트랜젝션 유지가 어렵다.
- 모놀리식은 단일 트랜젝션(DB)를 유지하면 된다.
- 반면에, MSA는 비즈니스에 대한 DB를 가지고 있는 서비스도 각기 다르고 서비스 연결을 위한 통신도 포함하고 있어 트랜젝션 유지가 어렵다.

### 통합 테스트 어려움
- 개발환경, 실제 운영환경을 동일하게 가져가기 어려움

### 배포 어려움
- 모놀로식은 서버 전체에 대해 배포하여 서비스간의 연계를 고려하는 것이 드물다.
- MSA는 한 개의 서비스를 재배포 한다고 하면 다른 서비스들관의 연계를 고려해야 한다.

<br><br><br>
<출처>
- https://sabarada.tistory.com/51?category=822070
- https://www.nginx.com/blog/introduction-to-microservices/
