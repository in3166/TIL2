# React - Behind the Scenes 
## How React Work
- React는 사용자 인터페이스를 만드는 라이브러리
- React는 Componenet에 대한 것이고 Component를 사용해 사용자 인터페이스를 만들고 효과적으로 업데이트 한다.
- React는 웹, 브라우저 자체를 알지 못하고, ReactDOM이 궁극적으로 HTML 요소들을 화면을 가져오는 웹 사이트의 인터페이스다.

- React는 `props`(부모-자식 간 소통, 컴포넌트 configuration), `state`(컴포넌트 내부 데이터), `context`(compoenet-wide data)만을 신결쓴다.
  - so, 위의 3가지가 변경될 때마다 이것들을 사용하는 컴포넌트들이 업데이트 될 때마다 화면에 새로운 것을 보여주려는 것인지 확인하고 그렇다면 React가 ReactDOM에게 알린다.
  - ReactDOM은 새로운 컴포넌트, 결과물을 화면으로 가져온다.

```
[Components] => [Real DOM] (HOW?)
```
### Virtual DOM
- `Virtual DOM`은 App이 만드는 `Component Tree`가 현재 (어떤 형태)어떻게 생겼고 (state update 이후)어떻게 생겨야 할지 결정한다.
- 결국, '현재 컴포넌트 트리와 미래의 트리의 차이점'을 알고 'RealDOM을 Virtual Snapshot에 맞추기 위해 어떻게 조작해야하는지' 등의 정보들을 React DOM은 전달받는다.

- 컴포넌트의 `state`, `props`, `context`이 바뀔 때마다 그 컴포넌트의 재실행되고, React에 의해 재평가 된다.
- 하지만, 재평가와 Re-rendering은 다른 것이다. (RealDOM이 재평가되거나 Re-render 되는게 아님)
- RealDOM은 오직 React가 가져온 이전의 Component state, Tree와 현재의 state, Tree와의 차이점에 근거하여 변경되어야 하는 부분만 업데이트한다.
  - 성능 상으로 좋은 이유가 (이전 state와 현재 state의) virtual 비교는 메모리 상에서 이루어 지기 때문이다.
  - RealDOM을 가지고 작업하는 것은 성능적으로 집약적 작업이다.

- 예제
  - Previous Evaluation Result: 컴포넌트가 마지막으로 render된 결과물
  ```html
  <div>
    <h1>Hi!</h1>
  </div>
  ```
  - Current Evaluation Result
  ```html
  <div>
    <h1>Hi!</h1>
    <p>Bye!</h1>
  </div>
  ```
- React가 위의 상황에서 차이점을 확인하고 두 Snapshot 사이에 `<p>` 구절이 다르다고 인식
- 이 변화를 React DOM에게 보고
- React DOM은 Real DOM을 업데이트
  - React DOM은 전체 DOM을 다시 render 하지 않고, `<h1>`, `<div>`를 만지지 않고 `<p>`를 삽입할 뿐
  - 즉, `<h1>`, `<div>`는 다시 렌더되지 않음 (dev tool에서 `<p>`만 깜박이면서 생겨남)
<br>

- Component는 `state`, `props`, `context`가 변경되면 재평가되고 다시 실행된다.
- 또한 부모 Component가 재평가되어 재실행되면 모든 자식 Component도 같이 재실행된다.
  - Isn't this bad?
    - React는 비교를 위한 실행에 굉장히 최적화되어 있다.
    - 그럼에도, 큰 애플리케이션에선 성능적 문제가 야기될 순 있다.
    - 그래서, 특정 상황에서만 자식 컴포넌트를 재실행하도록 설정할 수 있다. (props가 변경되는 경우 등)
    
- 다시 말하지만, 재실행 됐다고 Real DOM에 영향을 끼친 것은 아니다.
<br><br><br>
<출처>
- Udemy: React 완벽 가이드
